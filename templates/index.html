<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, initial-scale=1.0">

    <link rel="icon" type="image/ico" href="">
    <link rel="icon" href="">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"
        integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <!-- <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="app.js"></script> -->
    <title>TNT</title>
    <meta name="description" content="">
    <meta property="og:locale" content="">
    <meta property="og:site_name" content="">
    <meta property="og:type" content="">
    <meta property="og:title" content="">
    <meta property="og:description" content="">
    <meta property="og:url" content="">
    <meta property="og:image" content="">
    <meta property="og:image:secure_url" content="">
    <meta property="og:image:width" content="">
    <meta property="og:image:height" content="">
    <script src="https://www.youtube.com/iframe_api"></script>

</head>

<body>

    <div id="header-section" class="row btlined-box mx-0">
        <div class="col rlined-box">
            <nav class="navbar navbar-expand-lg navbar-light">
                <a class="navbar-brand mx-auto" href="#">TNT : Time N Text</a>
            </nav>
        </div>

        <div class="col">
        </div>
    </div>
    <div id="get-url-section" style="height: 56px;">
        <div class="container-fluid h-100">
            <form class="h-100" action="yt" method="post">

            <div id="get-url-box" class="container-md mx-auto xlined-box mw-700 h-100 row mx-0 px-0">
                <input class="btn-input col-10 h-100" id="txtUrl" placeholder="링크 입력" name="url" type="text" />
                <input class="btn-input col-2 llined-box h-100" type="submit" value="변환"/>
            </div>
        </form>
        </div>
    </div>
    <div id="result-section" class="row mx-0 btlined-box">
        <div id="video-section" class="rlined-box">
            <div id="player" class="iframe-container">
                <!-- <iframe class="yt-hd-thumbnail" id="link" src="https://www.youtube.com/embed/OD4hCqORK60?rel=0&amp;controls=0&amp;showinfo=0" frameborder="0" start="100"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"></iframe> -->
            </div>
        </div>
        <div id="script-section" class="col px-0">
            <div id="search-section" class="position-to-top btlined-box row mx-0">
                <div class="my-auto col-12">
                    <input id="" class="btn-input" placeholder="키워드 입력">
                </div>
            </div>
            <div id="timeline-section" class="w-100">
                <ul style="overflow: scroll; height: 100%;" class="mb-0 list-unstyled">
                    <li id="result-script" class="row btlined-box text-center position-relative w-100 li-style mx-0">
                        <div class="col-3 d-inline align-self-center text-black-50">
                            
                        </div>
                        <div class="h-100 rlined-box" style="width: 0px;"></div>
                    
                        <div id="script-result" class="col-8 text-left align-self-center d-inline">
                            <a class="seektotime" onclick="seekTotime();">
                            </a>
                        </div>
                    </li>
                </ul>
            </div>

        </div>
    </div>
</body>

<script type="text/javascript">
    let header = document.querySelector('#header-section');
    console.log(header);
    // let footer = document.querySelector('#footer-section');
    let getUrl = document.querySelector('#get-url-box');
    let result = document.querySelector('#result-section');
    let video = document.querySelector('#video-section');
    let script = document.querySelector('#script-section');
    let search = document.querySelector('#search-section');
    let timeline = document.querySelector('#timeline-section');

    // iframe 부분 너비 계산
    let getUrlW = window.getComputedStyle(getUrl).getPropertyValue('width').split('px');
    video.style.width = String(parseInt(getUrlW[0]) + (window.innerWidth - parseInt(getUrlW[0])) / 2) + 'px';

    // result 부분 높이 계산
    let headerH = window.getComputedStyle(header).getPropertyValue('height').split('px');
    // let footerH = window.getComputedStyle(footer).getPropertyValue('height').split('px');
    let getUrlH = window.getComputedStyle(getUrl).getPropertyValue('height').split('px');
    result.style.height = String(window.innerHeight - parseInt(headerH[0]) - parseInt(getUrlH[0])) + 'px';

    // script 부분 높이 계산
    let resultH = window.getComputedStyle(result).getPropertyValue('height').split('px');
    // let searchH = window.getComputedStyle(search).getPropertyValue('height').split('px');
    timeline.style.height = String(parseInt(resultH[0]) + 56) + 'px';
    video.style.height = String(parseInt(resultH[0])) + 'px';


    if (window.innerWidth <= 808) {
        header.classList.add('d-none');
        // footer.classList.add('d-none');
        video.classList.add('mobile-VideoSection');
        getUrl.classList.remove('xlined-box');

        let body = document.querySelector('body');
        body.style.height = String(window.innerHeight) + 'px';

        // result 부분 높이 계산
        let getUrlH = window.getComputedStyle(getUrl).getPropertyValue('height').split('px');
        result.style.height = String((window.innerHeight - parseInt(getUrlH[0]))) + 'px';
        video.style.height = String((window.innerHeight - parseInt(getUrlH[0])) / 2) + 'px';
        script.style.width = String(window.innerWidth) + 'px';

        // script 부분 높이 계산
        // let search = document.querySelector('#search-section');
        // let searchH = window.getComputedStyle(search).getPropertyValue('height').split('px');
        let resultH = window.getComputedStyle(result).getPropertyValue('height').split('px');

        let timeline = document.querySelector('#timeline-section');
        timeline.style.height = String((window.innerHeight - parseInt(getUrlH[0])) / 2) + 'px';

        search.classList.remove('position-to-top');
        // video.style.height = '100%';
    }

</script>
<script type="text/javascript">
    window.onresize = adjSriptSectionWd;
    function adjSriptSectionWd() {
        let header = document.querySelector('#header-section');
        // let footer = document.querySelector('#footer-section');
        let getUrl = document.querySelector('#get-url-box');
        let result = document.querySelector('#result-section');
        let video = document.querySelector('#video-section');
        let script = document.querySelector('#script-section');
        let search = document.querySelector('#search-section');
        let timeline = document.querySelector('#timeline-section');


        // iframe 부분 너비 계산
        let getUrlW = window.getComputedStyle(getUrl).getPropertyValue('width').split('px');
        video.style.width = String(parseInt(getUrlW[0]) + (window.innerWidth - parseInt(getUrlW[0])) / 2) + 'px';

        // result 부분 높이 계산
        let headerH = window.getComputedStyle(header).getPropertyValue('height').split('px');
        // let footerH = window.getComputedStyle(footer).getPropertyValue('height').split('px');
        let getUrlH = window.getComputedStyle(getUrl).getPropertyValue('height').split('px');
        result.style.height = String(window.innerHeight - parseInt(headerH[0]) - parseInt(getUrlH[0])) + 'px';

        // script 부분 높이 계산
        let resultH = window.getComputedStyle(result).getPropertyValue('height').split('px');
        // let searchH = window.getComputedStyle(search).getPropertyValue('height').split('px');
        timeline.style.height = String(parseInt(resultH[0]) + 56) + 'px';
        video.style.height = String(parseInt(resultH[0])) + 'px';

        if (window.innerWidth > 808) {
            video.classList.remove('mobile-VideoSection');
            header.classList.remove('d-none');

            getUrl.classList.add('xlined-box');
            search.classList.add('position-to-top');
        }
        else {
            video.classList.add('mobile-VideoSection');
            header.classList.add('d-none');
            // footer.classList.add('d-none');
            getUrl.classList.remove('xlined-box');
            // result.classList.remove('btlined-box');
            let body = document.querySelector('body');
            body.style.height = String(window.innerHeight) + 'px';

            // result 부분 높이 계산
            let getUrlH = window.getComputedStyle(getUrl).getPropertyValue('height').split('px');
            result.style.height = String((window.innerHeight - parseInt(getUrlH[0]))) + 'px';
            video.style.height = String((window.innerHeight - parseInt(getUrlH[0])) / 2) + 'px';
            script.style.width = String(window.innerWidth) + 'px';

            // script 부분 높이 계산
            // let search = document.querySelector('#search-section');
            // let searchH = window.getComputedStyle(search).getPropertyValue('height').split('px');
            let resultH = window.getComputedStyle(result).getPropertyValue('height').split('px');

            let timeline = document.querySelector('#timeline-section');

            timeline.style.height = String((window.innerHeight - parseInt(getUrlH[0])) / 2) + 'px';

            search.classList.remove('position-to-top');
        }
    }
</script>
<script type="text/javascript">
    // const inputBox = document.querySelector('#txtUrl');
    // console.log(inputBox);
    // inputBox.addEventListener('input', checkValue);

    // function checkValue(e) {
    //     // console.log(e.target.value);
    //     let searchKey = 'youtube'
    //     let btn = document.querySelector('.btn-input');
    //     if(e.target.value.search(searchKey) > -1){
    //         btn.classList.remove('d-none');
    //         console.log("dd");
    //     }
    //     else{
    //         btn.classList.add('d-none');
    //     }
    // }
</script>

<script type="text/javascript">

    let resultScript = document.querySelectorAll("#script-result");
    let target = resultScript[resultScript.length - 1].innerHTML;
    console.log(target.trim());

    // 2. This code loads the IFrame Player API code asynchronously.
    var tag = document.createElement('script');

    tag.src = "https://www.youtube.com/iframe_api";
    var firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

    // 3. This function creates an <iframe> (and YouTube player)
    //    after the API code downloads.
    var player;
    function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', {
            videoId: target.trim(),
        });
    }

    function seekTotime() {
        player.seekTo(22);
    }


    function setBrowserFrameSource() {
        let initialUrl = document.getElementById("txtUrl").value;
        let urlArray = initialUrl.split("watch?v=");
        let new_url = urlArray[0] + 'embed/' + urlArray[1];

        let browserFrame = document.getElementById("link");
        browserFrame.src = new_url;
        browserFrame.start = Math.floor(Math.random() * 11);


    }
    //https://www.youtube.com/watch?v=A9Fw4O0dFTY 에서 watch?v= 제거하고 embed/를 삽입.
</script>
<script type="text/javascript">

</script>
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="app.js"></script>

</html>